{% extends "base.html" %}

{% load custom_filters %}

{% block main %}
  <div class="row">

    {% include "project_side_bar_left.html" %}

    <div class="col-12 col-md-6">

      {% include "message_error.html" %}

      <div class="mb-3">
        The {{ entry_type }} has been saved,
        {% if entry_update_outcome.name %}named <strong>{{ entry_update_outcome.name }}</strong>,{% endif %}
        numbered <strong>{{ entry_update_outcome.id }}</strong>.
      </div>
      <div class="mb-3">Would you now like to:</div>
      <div class="mb-3">
        <a class="link-dcsp"
           id="id_link_entry_saved"
           onclick="url_click('{% url "view_docs" project_id entry_update_outcome.entries_url %}')">Published view</a>
      </div>
      <div class="mb-3">
        <a class="link-dcsp"
           href="{% url 'entry_update' project_id entry_type id_new %}">Edit the same {{ entry_type }}</a>
      </div>
      <div class="mb-3">
        <a class="link-dcsp"
           href="{% url 'entry_update' project_id entry_type 'new' %}">Create another {{ entry_type }}</a>
      </div>
 
    </div>
 

    {% include "project_side_bar_right.html" %}

  </div>

  <!--<script>
    var labelsForCalculations = {{ form.labels_for_calculations|safe }};
    var calculationField = {{ form.calculation_field|safe }};


    function handleFieldChange(event) {
      var calculationKey = {};
      var searchKey = "";
      var calculation_output = "";

      for (var key in labelsForCalculations) {
        var changedValue = document.getElementById(key).value.split('.')[0];
        if (changedValue == ""){
          changedValue = 0
        }

        calculationKey[labelsForCalculations[key]] = changedValue;
        
      }

      for (const element of calculationField) {
        searchKey = ""
        var matched = false;
        var calculationFieldID = document.getElementById(element["id"]);

        //console.log(element);
        for (const [key, value] of Object.entries(element["monitor_labels"])) {
          for (const [key2, value2] of Object.entries(calculationKey)) {
            if (key2 == value){
              searchKey += key2 + value2 + "-"
            }
          }
        }

        if (searchKey.endsWith('-')) {
          searchKey = searchKey.slice(0, -1);
        }

        for (const [key3, value3] of Object.entries(element["choices"])) {
          if (value3.includes(searchKey)){
            calculationFieldID.value = key3;
            matched = true;
            break;
          }
        }

        if (matched == false){
          calculationFieldID.value = "";
        }
      }
    }

    for (var key in labelsForCalculations) {
      const field = document.getElementById(key);
      if (field) {
        field.addEventListener('change', handleFieldChange);
      }
    }

  </script>-->
{% endblock main %}
